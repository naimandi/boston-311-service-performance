import requests
import os

os.makedirs("Data", exist_ok=True)

csv_urls = {
    "2025": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/9d7c2214-4709-478a-a2e8-fb2020a5bb94/tmpl9odexw6.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014945Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=a05be4400d9dd5e51344989045b23a2270e8f4e6e99ebee08776665bc523a0db",
    "2024": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/dff4d804-5031-443a-8409-8344efd0e5c8/tmpm461rr5o.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014912Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=6e47682bf3a68a230b5e22493c7e918aebdf727f9204b707a363b50e4fcecd8f",
    "2023": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/e6013a93-1321-4f2a-bf91-8d8a02f1e62f/tmpwbgyud93.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014909Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=5356bfe77cf6e6cc7ced6df5a5a692812ef45e969c66602baca3a11f458e4bf3",
    "2022": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/81a7b022-f8fc-4da5-80e4-b160058ca207/tmpfm8veglw.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014907Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=0329d9b925df73107fda5b0608c07bc1c552a404c7a1dcdbc4b0747d24a48da9",
    "2021": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/f53ebccd-bc61-49f9-83db-625f209c95f5/tmp88p9g82n.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014905Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=9965b2836c791b4aa953fb542ff7f1ebc60f58cd186508b3310cc3cf43b66059",
    "2020": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/6ff6a6fd-3141-4440-a880-6f60a37fe789/tmpcv_10m2s.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014857Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=d1dbd79b4303ae2370b5d512a795739054bc0b57785be8558ec6ebdc6b2a9d56",
    "2019": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/ea2e4696-4a2d-429c-9807-d02eb92e0222/tmpcje3ep_w.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T015416Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=61f26bfb2be5c4a84d1abf66efba7ed6531ac6d880829295332d9747cac07c13",
    "2018": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/2be28d90-3a90-4af1-a3f6-f28c1e25880a/tmp7602cia8.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014231Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=0018602bb4dd6d77fa630e19a77f798c295b8b912f53b614895d22f4662a2854",
    "2017": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/30022137-709d-465e-baae-ca155b51927d/tmpzccn8u4q.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T015728Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=3ac49b6aa5020f4e4618974ff0e179bbb70f651d975d26d75977eb135e1cba4b",
    "2016": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/b7ea6b1b-3ca4-4c5b-9713-6dc1db52379a/tmpzxzxeqfb.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014213Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=bdc49ff832824554bec61a00b5d6bffe746810c945fceac9327eb154f967be4b",
    "2015": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/c9509ab4-6f6d-4b97-979a-0cf2a10c922b/tmphrybkxuh.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T015406Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=9ebb8b31fe02d8da915eb301bc69a7e67daff1812b74661ecada48885870f843",
    "2014": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/bdae89c8-d4ce-40e9-a6e1-a5203953a2e0/tmp8afxvko_.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T015404Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=aa4f823403e902a7f118b0dee956d9b991f8e437207a838328d740e599bd1cdd",
    "2013": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/407c5cd0-f764-4a41-adf8-054ff535049e/tmpyzk_wmya.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T014208Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=f4a931fe0b7b8fb980f5528f997b9d3444b3a1b20f29b8f10bdf5a0c9ebf2b55",
    "2012": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/382e10d9-1864-40ba-bef6-4eea3c75463c/tmpeyvgdt5u.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T015238Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=30283692b63fc2854e2c2d7789640f051ce1731f05e983fa74b6e5585a1dec11",
    "2011": "https://s3.amazonaws.com/og-production-open-data-bostonma-892364687672/resources/94b499d9-712a-4d2a-b790-7ceec5c9c4b1/tmp_9ogynu0.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJJIENTAPKHZMIPXQ%2F20260110%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20260110T015236Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-Amz-Signature=10c2daecc7e66dd61de2de6d2b82926ab66cf97dd5ae06ad723b345a889b5a00",

}

for year, url in csv_urls.items():
    local_file = f"Data/311_{year}.csv"
    print(f"Downloading {year} to {local_file} ...")
    r = requests.get(url)
    with open(local_file, "wb") as f:
        f.write(r.content)
    print(f"Downloaded {year}")
